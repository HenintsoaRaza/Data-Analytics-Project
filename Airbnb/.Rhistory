proportion_neighborhood<- ggplot(listings, aes(neighbourhood_cleansed))
proportion_neighborhood +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),2)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
#scale_y_discrete(guide = guide_axis(check.overlap = TRUE))+
ylab("Percentage ") + theme(legend.position = "none") + coord_flip()
listings %>%
group_by(city, room_type, bedrooms, neighbourhood_cleansed) %>%
summarise(average_availability_30 = mean(availability_30))
listings %>%
group_by(city, room_type, bedrooms, neighbourhood_cleansed) %>%
summarise(average_revenue_30 = mean(revenue_30))
avgAvai30_city_roomType <- ggplot(listings, aes(city, availability_30, fill=city))
avgAvai30_city_roomType + geom_boxplot(aes(colour = room_type),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$availability_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
avgAvai30_city_bedrooms <- ggplot(listings, aes(city, availability_30, fill=city))
avgAvai30_city_bedrooms + geom_boxplot(aes(colour = bedrooms),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$availability_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
avgAvai30_city_neighbourhood_cleansed <- ggplot(listings, aes(city, availability_30, fill=city))
avgAvai30_city_neighbourhood_cleansed + geom_boxplot(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$availability_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
proportion_RoomType <- ggplot(listings, aes(room_type))
proportion_RoomType + geom_bar(color="blue", width=0.8 , fill="darkgreen") +
geom_text(aes(label=stat(count)), stat='count', vjust = -0.3) +
ylab("Percentage")
```{r}
proportion_RoomType <- ggplot(listings, aes(room_type))
proportion_RoomType + geom_bar(color="blue", width=0.8 , fill="darkgreen") +
geom_text(aes(label=stat(count)), stat='count', vjust = -0.3) +
ylab("Percentage")
u
proportion_RoomType2<- ggplot(listings, aes(room_type))
proportion_RoomType2 +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),4)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) + theme(legend.position = "none")
proportion_RoomType <- ggplot(listings, aes(room_type))
proportion_RoomType + geom_bar((aes(colour = city)), color="blue", width=0.8 , fill="darkgreen") +
geom_text(aes(label=stat(count)), stat='count', vjust = -0.3) +
ylab("Percentage")
proportion_RoomType <- ggplot(listings, aes(room_type))
proportion_RoomType + geom_bar(color="blue", width=0.8 , fill="darkgreen") +
geom_text(aes(label=stat(count)), stat='count', vjust = -0.3) +
ylab("Percentage") + facet_wrap(~ city)
proportion_RoomType <- ggplot(listings, aes(room_type))
proportion_RoomType + geom_bar(color="blue", width=0.8 , fill= city) +
geom_text(aes(label=stat(count)), stat='count', vjust = -0.3) +
ylab("Percentage") + facet_wrap(~ city)
proportion_RoomType <- ggplot(listings, aes(room_type, fill= city))
proportion_RoomType + geom_bar(color="blue", width=0.8 ) +
geom_text(aes(label=stat(count)), stat='count', vjust = -0.3) +
ylab("Percentage") + facet_wrap(~ city)
proportion_RoomType2<- ggplot(listings, aes(room_type, fill= city))
proportion_RoomType2 +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),4)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) + theme(legend.position = "none") + facet_wrap(~ city)
proportion_RoomType <- ggplot(listings, aes(room_type, fill= city))
proportion_RoomType + geom_bar(color="blue", width=0.8 ) +
geom_text(aes(label=stat(count)), stat='count', vjust = -0.3) +
ylab("Percentage") + facet_wrap(~ city) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
proportion_RoomType2<- ggplot(listings, aes(room_type, fill= city))
proportion_RoomType2 +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),4)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) + theme(legend.position = "none") + facet_wrap(~ city) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
proportion_bedrooms<- ggplot(listings, aes(bedrooms))
proportion_bedrooms +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),4)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
ylab("Percentage ") + theme(legend.position = "none")
+ + facet_wrap(~ city) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
proportion_bedrooms<- ggplot(listings, aes(bedrooms, fill= city))
proportion_bedrooms +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),4)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
ylab("Percentage ") + theme(legend.position = "none")
+ + facet_wrap(~ city) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
proportion_bedrooms<- ggplot(listings, aes(bedrooms, fill= city))
proportion_bedrooms +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),4)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
ylab("Percentage ") + theme(legend.position = "none")
+ facet_wrap(~ city) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
proportion_bedrooms<- ggplot(listings, aes(bedrooms, fill= city))
proportion_bedrooms +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),4)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
ylab("Percentage ") + theme(legend.position = "none") + facet_wrap(~ city) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
proportion_bedrooms<- ggplot(listings, aes(bedrooms, fill= city))
proportion_bedrooms +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),4)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
ylab("Percentage ") + theme(legend.position = "none") + facet_wrap(~ city)
avgAvai30_city_roomType <- ggplot(listings, aes(city, availability_30, fill=city))
avgAvai30_city_roomType + geom_boxplot(aes(colour = room_type),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$availability_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
proportion_neighborhood<- ggplot(listings, aes(neighbourhood_cleansed))
proportion_neighborhood +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),2)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
scale_y_discrete(guide = guide_axis(check.overlap = TRUE))+
ylab("Percentage ") + theme(legend.position = "none") + coord_flip()
proportion_neighborhood<- ggplot(listings, aes(neighbourhood_cleansed))
proportion_neighborhood +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),2)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
ylab("Percentage ") + theme(legend.position = "none") + coord_flip()
d <- data.table(listings, key="neighbourhood_cleansed")
d[, head(.SD, 3), by=neighbourhood_cleansed]
d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
d <- data.table(listings, key="neighbourhood_cleansed")
d
#d[, head(.SD, 3), by=neighbourhood_cleansed]
d <- data.table(listings, key="city")
d[, head(.SD, 3), by=neighbourhood_cleansed]
d <- data.table(listings, key="city")
d[, head(.SD, 3), by=neighbourhood_cleansed]
d <- data.table(listings, key="city")
d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
summarise(re = most.frequent(neighbourhood_cleansed))
listings %>%
group_by(city) %>%
summarize(re = most.frequent(neighbourhood_cleansed))
listings %>%
group_by(city) %>%
summarize(re = most.frequent(neighbourhood_cleansed))
listings %>%
group_by(city) %>%
summarize(re = names(which.max(table(b))))
listings %>%
group_by(city) %>%
summarize(re = names(which.max(table(neighbourhood_cleansed))))
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
ount(city, neighbourhood_cleansed) %>%
slice(which.max(10))
listings %>%
count(city, neighbourhood_cleansed) %>%
slice(which.max(10))
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(1)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(2)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(1)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(2)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
#top_n(2)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed)
#top_n(2)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed)
arrange(desc(Count))
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed)
arrange(desc(count))
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
arrange(desc(count))
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
arrange(desc())
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
arrange(desc(n))
#top_n(2)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed)
#arrange(desc(n))
#top_n(2)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed)
top_n(10)
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(10)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
arrange(desc(n)) %>%
top_n(2)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
arrange(desc(n)) %>%
top_n(10)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(10) %>%
arrange(desc(n))
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(10)
#d <- data.table(listings, key="neighbourhood_cleansed")
#d[, head(.SD, 3), by=neighbourhood_cleansed]
listings %>%
group_by(city == malaga) %>%
count(neighbourhood_cleansed) %>%
top_n(10)
top_10_neighborhood <- listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(10)
top_10_neighborhood
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(neighbourhood_cleansed))
proportion_10neighborhood +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),2)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
ylab("Percentage ") + theme(legend.position = "none") + coord_flip()
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(neighbourhood_cleansed, fill= city))
proportion_10neighborhood +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),2)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
ylab("Percentage ") + theme(legend.position = "none") + coord_flip()
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(neighbourhood_cleansed, fill= city))
proportion_10neighborhood +
geom_bar(aes(y = (..count..)/sum(..count..), fill=factor(..x..)), stat= "count")+
geom_text(aes(label = scales::percent(round((..count..)/sum(..count..),2)),
y= ((..count..)/sum(..count..))), stat="count",
vjust = -.25) +
ylab("Percentage ") + theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(neighbourhood_cleansed, fill= city))
proportion_10neighborhood +
geom_bar(color="blue", width=0.8 ) +
geom_text(aes(label=stat(count)), stat='count', vjust = -0.3) +
ylab("Percentage ") + theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
a <- ggplot(listings, aes(city, revenue_30, fill=city))
a + geom_boxplot(aes(colour = room_type),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$revenue_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
a <- ggplot(listings, aes(city, revenue_30, fill=city))
a <- ggplot(listings, aes(city, revenue_30, fill=city))
a + geom_boxplot(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$revenue_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
a <- ggplot(listings, aes(top_10_neighborhood, revenue_30, fill=city))
a + geom_boxplot(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$revenue_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
a <- ggplot(listings, aes(top_10_neighborhood, revenue_30, fill=city))
a + geom_boxplot(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(top_10_neighborhood$revenue_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
a <- ggplot(top_10_neighborhood, aes(city, revenue_30, fill=city))
a + geom_boxplot(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(top_10_neighborhood$revenue_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
a <- ggplot(top_10_neighborhood, aes(city, n, fill=city))
a + geom_boxplot(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_fill_brewer(palette="Set1")
top_10_neighborhood <- listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(count = 10)
top_10_neighborhood <- listings %>%
group_by(city) %>%
count(neighbourhood_cleansed) %>%
top_n(10)
top_10_neighborhood
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, n, fill= city))
proportion_10neighborhood +
geom_bar(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
ylab("Percentage ") + theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
a <- ggplot(top_10_neighborhood, aes(city, n, fill=city))
a + geom_bar(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_fill_brewer(palette="Set1")
a <- ggplot(top_10_neighborhood, aes(city, n, fill=city))
a + geom_boxplot(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_fill_brewer(palette="Set1")
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
ylab("Percentage ") + theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(colour = neighbourhood_cleansed),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(neighbourhood_cleansed, n),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip()
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + facet_wrap(~ city)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city) + ylab("neighborhood ")
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city) + xlab("neighborhood ")
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city) + xlab("neighborhood ") + ylab("proportion")
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city) + xlab("neighborhood ") + ylab("proportion")
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city) + xlab("neighborhood ") + ylab("proportion") +
geom_text(aes(label=n), stat="identity", vjust = -0.3)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city) + xlab("neighborhood ") + ylab("proportion") +
geom_text(aes(label=n), vjust = -0.3)
proportion_10neighborhood<- ggplot(top_10_neighborhood, aes(city, fill= city))
proportion_10neighborhood +
geom_bar(aes(x = neighbourhood_cleansed, y = n), stat="identity",  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
theme(legend.position = "none") + coord_flip() + facet_wrap(~ city) + xlab("neighborhood ") + ylab("proportion")
avgRev30_city_roomType <- ggplot(listings, aes(city, revenue_30, fill=city))
avgRev30_city_roomType + geom_boxplot(aes(colour = room_type),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$revenue_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(city, revenue_30, fill=city))
distRev30_city_roomType + geom_boxplot(aes(colour = room_type),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$revenue_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(city, revenue_30, fill=city))
distRev30_city_roomType + geom_density(aes(colour = room_type),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_y_continuous(limits = quantile(listings$revenue_30, c(0.1, 0.9), na.rm = T)) +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(city, revenue_30, fill=city))
distRev30_city_roomType + geom_density(aes(colour = room_type),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(city, revenue_30))
distRev30_city_roomType + geom_density(aes(colour = room_type),  lwd = 0.8, position = position_dodge(0.9), na.rm = T) +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(city, revenue_30))
distRev30_city_roomType + geom_density(aes(colour = room_type), na.rm = T) +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(city, revenue_30))
distRev30_city_roomType + geom_density(aes(colour = room_type),  lwd = 0.8, na.rm = T) +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = room_type))
distRev30_city_roomType + geom_density() +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = room_type))
distRev30_city_roomType + geom_density(aes(colour = city),  lwd = 0.8, na.rm = T) +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = room_type))
distRev30_city_roomType + geom_density(alpha = 0.5, aes(colour = city),  lwd = 0.8, na.rm = T) +
scale_fill_brewer(palette="Set1")
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = room_type))
distRev30_city_roomType + geom_density(alpha = 0.5, aes(colour = city),  lwd = 0.8, na.rm = T) + facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = room_type))
distRev30_city_roomType + geom_density(alpha = 0.5) + facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, color = room_type))
distRev30_city_roomType + geom_density(alpha = 0.5) + facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = room_type))
distRev30_city_roomType + geom_density(alpha = 0.5) + facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = city))
distRev30_city_roomType + geom_density(alpha = 0.5) + facet_wrap(~ room_type)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = room_type))
distRev30_city_roomType + geom_density(alpha = 0.5) + facet_wrap(~ city)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_density(alpha = 0.5) + facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = room_type))
distRev30_city_roomType + geom_density(alpha = 0.5) + facet_wrap(~ city)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), alpha=0.5,position="identity")   + facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, fill = room_type))
distRev30_city_roomType + geom_histogram(aes(y=..density..), alpha=0.5,position="identity") + facet_wrap(~ city)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), alpha=0.5,position="identity")   + facet_wrap(~ city) + stat_bin(bins = 5)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), alpha=0.5,position="identity")   + facet_wrap(~ city) + stat_bin(bins = 30)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), alpha=0.5,position="identity")   + facet_wrap(~ city) + stat_bin(bins = revenue_30)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), alpha=0.5,position="identity")   + facet_wrap(~ city) + stat_bin(bins = 10)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, color = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), alpha=0.5,position="identity")   + facet_wrap(~ city) + stat_bin(bins = 10)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), alpha=0.5,position="identity")   + facet_wrap(~ city) + stat_bin(bins = 10)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), bins = 10, alpha=0.5,position="identity")   + facet_wrap(~ city)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), alpha=0.5,position="identity")   + facet_wrap(~ city) + stat_bin(bins = 10)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(aes(y=..density..), alpha=0.5,position="identity")   + facet_wrap(~ city) + stat_bin(bins = 10)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, group = room_type, fill = room_type))
distRev30_city_roomType + geom_histogram(aes(y=..density..), alpha=0.5,position="identity") + facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, group = room_type, fill = room_type))
distRev30_city_roomType + geom_histogram(adjust=1.5, alpha=.4) + facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, group = room_type, fill = room_type))
distRev30_city_roomType + geom_density(adjust=1.5, alpha=.4) + facet_wrap(~ city)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(binwidth=.5, position="dodge") + facet_wrap(~ city) + stat_bin(bins = 10)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(binwidth=.5, position="dodge") + facet_wrap(~ city)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(binwidth=.5, alpha=.5, position="identity") + facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, group = room_type, fill = room_type))
distRev30_city_roomType + geom_density(adjust=1.5, alpha=.4) + facet_wrap(~ city)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(binwidth=.5, alpha=.5, position="identity")
+ facet_wrap(~ city)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, group = city, fill = city))
distRev30_city_roomType + geom_density(adjust=1.5, alpha=.4) + facet_wrap(~ room_typecity)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, group = city, fill = city))
distRev30_city_roomType + geom_density(adjust=1.5, alpha=.4) + facet_wrap(~ room_type)
distRev30_city_roomType <- ggplot(listings, aes(revenue_30, group = room_type, fill = room_type))
distRev30_city_roomType + geom_density(adjust=1.5, alpha=.4) + facet_wrap(~ city)
distRev30_city_bedrooms <- ggplot(listings, aes(revenue_30, fill = bedrooms))
distRev30_city_bedrooms + geom_histogram(binwidth=.5, alpha=.5, position="identity") + facet_wrap(~ city)
